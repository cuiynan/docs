[TOC]

# 开发
## idea

### MVN
#### Cannot download sources
当出现下载不了相关联的jar包源码时，打开terminal输入命令：
	mvn dependency:resolve -Dclassifier=sources
自动下载 。
#### 打包时
	如果遇到目标包中含可执行moudle，必须增加下方依赖才能打包，否则提示JRE/JDK not bound等奇怪的错误提示。
```
<plugin>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-maven-plugin</artifactId>
    <configuration>
        <classifier>exec</classifier>
    </configuration>
</plugin>
```
#### 打包时遇到提示缺少distributionManagement
需要增加 下面类似代码，注意：在version时，打snapshots时需要在version后面增加   <version>0.0.2-SNAPSHOT</version>.
```
    <distributionManagement>
        <snapshotRepository>
            <id>snapshots</id>
            <name>Nexus Snapshot Repository</name>
            <url>http://140.143.135.112/nexus/content/repositories/snapshots/</url>
        </snapshotRepository>
    </distributionManagement>
```
## spingBoot相关问题

### 各种坑
1. @Asyn 不能在同一类中，否则失效。
1. 在搭建第一个SpringBoot项目时，Application启动类与controller等放在不同包中。注：启动SpringBoot的Application时，自动扫描Application.java类的同级与它的下级目录，其实目录并不进行扫描。故HTTP访问时会返回404错误码。
1. application.properties使用环境变量时，如果没有默认值 ，程序会报错。如：redis中password: ${REDIS_PASSWORD:}会启动报错，password: ${REDIS_PASSWORD:1}成功加载。
###  跨域
 **协议、域名、端口号都相同，只要有一个不相同，那么都是非同源。**
同源策略它是由 Netscape 提出的一个安全策略，它是浏览器最核心也是最基本的安全功能，如果缺少同源策略，则浏览器的正常功能可能都会受到影响，现在所有支持JavaScript的浏览器都会使用这个策略。
解决：
	a.在前端使用jsonp进行跨域访问，缺点是只能使用GET方法。
	b.后端处理，前端使用ajax便可。后端需要增加response.setHeader("Access-Control-Allow-Origin","*");

## spingCloud相关问题
### 报错
```java
1. The injection point has the following annotations:
	- @org.springframework.beans.factory.annotation.Autowired(required=true)
   java.net.Inet6AddressImpl.getHostByAddr(Native Method)
原因是在springcloud2.0以上@FeignClient更改为org.springframework.cloud.openfeign.FeignClient包，依赖:    、
<dependency>
    <groupId>org.springframework.cloud</groupId>
    <artifactId>spring-cloud-openfeign-core</artifactId>
    <version>2.1.2.RELEASE</version>
</dependency>
2. 
```
# 线上
## 数据库端
#### mysql

##### timeout
现象：
```
com.mysql.jdbc.CommunicationsException: The last packet successfully received from the server was58129 seconds ago.The last packet sent successfully to the server was 58129 seconds ago, which is longer than the server configured value of 'wait_timeout'. You should consider either expiring and/or testing connection validity before use in your application, increasing the server configured values for client timeouts, or using the Connector/J connection property 'autoReconnect=true' to avoid this problem. 
```
原因：
由于mysql默认连接闲置为8小时，超过8小时后MYSQL后断开连接，但在程序中的连接池并不知道断开，故会报上述异常信息。
解决方法：
msyql5后（含）使用阿里Druid连接池，加上下面相关配置，进行设置。
```
    timeBetweenEvictionRunsMillis: 60000
    minEvictableIdleTimeMillis: 30000
    validationQuery: SELECT 'x'
    testWhileIdle: true
    testOnBorrow: false
    testOnReturn: false
```
mysql5之前版本在连接处加上autoReconnect=true。